# Chunk 5
## Which dog breeds are in our data?
adoptions %>%
mutate(intake_subtype = fct_lump(intake_subtype, n=15)) %>%
group_by(intake_subtype) %>%
count(sort = TRUE)
# Chunk 6
intake <- adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE)) %>%
ggplot(aes(x=intake_month))+
geom_bar()+ggtitle("Intake Month")
outcome <- adoptions %>%
filter(!is.na(outcome_date)) %>%
mutate(outcome_month = month(outcome_date, label = TRUE)) %>%
ggplot(aes(x=outcome_month))+
geom_bar()+ ggtitle("Outcome Month")
gridExtra::grid.arrange(intake, outcome)
# Chunk 7
adoptions %>%
filter(dog == 1) %>%
mutate(adopted = as.factor(adopted),
pitbull = as.factor(pitbull)) %>%
ggplot(aes(x = pitbull, fill = adopted))+
geom_bar(position = "fill")
# Chunk 8
adoptions %>%
filter(dog == 1) %>%
mutate(euthanized = as.factor(euthanized),
pitbull = as.factor(pitbull)) %>%
ggplot(aes(x = pitbull, fill = euthanized))+
geom_bar(position = "fill")
adoptions %>%
filter(dog == 1) %>%
mutate(outcome = as.factor(outcome_type),
pitbull = as.factor(pitbull)) %>%
ggplot(aes(x = pitbull, fill = outcome))+
geom_bar(position = "fill")
adoptions %>%
filter(dog == 1) %>%
mutate(outcome = as.factor(outcome_type),
pitbull = as.factor(pitbull)) %>%
group_by(pitbull, outcome_type) %>%
count(name = "freq") %>%
group_by(pitbull)%>%
mutate(freq = freq/ sum(freq))%>%
spread(outcome_type,freq)
adoptions %>%
filter(dog == 1 | cat == 1) %>%
mutate(DogCat = ifelse(dog == 1, "Dog", "Cat")) %>%
group_by(DogCat) %>%
summarise(count = n(),
meanDays = mean(shelter_days, na.rm = TRUE),
prop_euth = sum(euthanized)/count,
prop_adopt = sum(adopted)/count,
prop_stray = sum(stray)/count)
adoptions %>%
filter(dog == 1 | cat == 1) %>%
filter(shelter_days < 100) %>%
mutate(DogCat = ifelse(dog == 1, "Dog", "Cat")) %>%
ggplot(aes(x=shelter_days, y=..density..)) +
geom_histogram()+
facet_grid(~DogCat)
names(adoptions)
# For Jack keep the line below for reading in the data
adoptions <- read_csv("adoptions.csv")
library(tidyverse)
library(readr)
library(lubridate)
# For Jack keep the line below for reading in the data
adoptions <- read_csv("adoptions.csv")
library(tidyverse)
## Which dog breeds are in our data?
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
## Which cat breeds are in our data?
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
## Which types of wildlife are in our data?
adoptions %>%
filter(animal_type == "WILDLIFE") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
names(adoptions)
adoptions$animal_type
## Which dog breeds are in our data?
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=animal_breed, y=n))+
geom_bar(stat="count")
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=animal_breed, y=n))+
geom_bar(stat="identity")
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=animal_breed, y=n))+
geom_bar(stat="identity")+
coord_flip()
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
# Chunk 1
library(tidyverse)
library(readr)
adoptions <- read_csv("~/Stats 316 S19/Project/adoptions/adoptions.csv")
## Which dog breeds are in our data?
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
## Which cat breeds are in our data?
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
## Which types of wildlife are in our data?
adoptions %>%
filter(animal_type == "WILDLIFE") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
library(tidyverse)
library(readr)
adoptions <- read_csv("~/Stats 316 S19/Project/adoptions/adoptions.csv")
adoptions <- read_csv("~/Stats 316 S19/Project/adoptions/adoptions.csv")
# For Jack keep the line below for reading in the data
adoptions <- read_csv("adoptions.csv")
head(adoptions)
view(adoptions)
adoptions %>%
mutate(month = as.factor(month(outcome_date)))%>%
filter(!is.na(month))%>%
ggplot() +
geom_bar(aes(x=month))
adoptions %>%
mutate(month = month(outcome_date))%>%
filter(!is.na(month))%>%
filter(animal_type=="CAT"| animal_type=="DOG"|animal_type=="BIRD")%>%
ggplot() +
geom_density(aes(x=month, color=animal_type, fill=animal_type, alpha=.1))+
scale_x_discrete("month", limits=as.character(1:12))
names(adoptions)
# For Jack keep the line below for reading in the data
adoptions <- read_csv("adoptions.csv")
head(adoptions)
view(adoptions)
adoptions %>%
mutate(month = as.factor(month(outcome_date)))%>%
filter(!is.na(month))%>%
ggplot() +
geom_bar(aes(x=month))
adoptions %>%
mutate(month = month(outcome_date))%>%
filter(!is.na(month))%>%
filter(animal_type=="CAT"| animal_type=="DOG"|animal_type=="BIRD")%>%
ggplot() +
geom_density(aes(x=month, color=animal_type, fill=animal_type, alpha=.1))+
scale_x_discrete("month", limits=as.character(1:12))
adoptions %>%
filter(animal_type=="WILDLIFE") %>%
group_by(animal_breed) %>%
summarise(n()) %>%
print(n=32)
adoptions%>%
filter(dog == 1) %>%
filter(adopted == 1) %>%
group_by(outcome_date) %>%
tally() %>%
ggplot()+
geom_histogram(aes(x=n))
adoptions%>%
filter(dog==1)%>%
group_by(pitbull)%>%
summarise(mean(adopted))
## Which dog breeds are in our data?
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
## Which cat breeds are in our data?
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
## Which types of wildlife are in our data?
adoptions %>%
filter(animal_type == "WILDLIFE") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(dog == 1 | cat == 1) %>%
ggplot(aes(x=animal_origin))+
geom_bar()+
facet_grid(~animal_type)
## General distribution of variable
adoptions %>%
filter(dog == 1 | cat == 1) %>%
ggplot(aes(x=chip_status))+
geom_bar()+
facet_grid(~animal_type)
## Relationship with returned to owner status
adoptions %>%
filter(dog == 1 | cat == 1) %>%
filter(!is.na(chip_status)) %>%
mutate(returned = as.factor(ifelse(outcome_type== "RETURNED TO OWNER", 1, 0))) %>%
ggplot(aes(x=chip_status, fill = returned))+
geom_bar(position = "fill")
## Which dog breeds are in our data?
adoptions %>%
mutate(intake_subtype = fct_lump(intake_subtype, n=15)) %>%
group_by(intake_subtype) %>%
count(sort = TRUE)
intake <- adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE)) %>%
ggplot(aes(x=intake_month))+
geom_bar()+ggtitle("Intake Month")
intake <- adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE)) %>%
ggplot(aes(x=intake_month))+
geom_bar()+ggtitle("Intake Month")
intake <- adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE)) %>%
ggplot(aes(x=intake_month))+
geom_bar()+
ggtitle("Intake Month")
names(adoptions)
intake <- adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE)) %>%
ggplot(aes(x=intake_month))+
geom_bar()+
ggtitle("Intake Month")
?lubridate
library(lubridate)
intake <- adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE)) %>%
ggplot(aes(x=intake_month))+
geom_bar()+
ggtitle("Intake Month")
library(tidyverse)
library(readr)
library(lubridate)
## Which dog breeds are in our data?
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(animal_type == "DOG") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
## Which cat breeds are in our data?
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(animal_type == "CAT") %>%
mutate(animal_breed = fct_lump(animal_breed, n=15)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)%>%
ggplot(aes(x=fct_reorder(animal_breed,n), y=n))+
geom_bar(stat="identity")+
coord_flip()
## Which types of wildlife are in our data?
adoptions %>%
filter(animal_type == "WILDLIFE") %>%
mutate(animal_breed = fct_lump(animal_breed, n=10)) %>%
group_by(animal_breed) %>%
count(sort = TRUE)
adoptions %>%
filter(dog == 1 | cat == 1) %>%
ggplot(aes(x=animal_origin))+
geom_bar()+
facet_grid(~animal_type)
## General distribution of variable
adoptions %>%
filter(dog == 1 | cat == 1) %>%
ggplot(aes(x=chip_status))+
geom_bar()+
facet_grid(~animal_type)
## Relationship with returned to owner status
adoptions %>%
filter(dog == 1 | cat == 1) %>%
filter(!is.na(chip_status)) %>%
mutate(returned = as.factor(ifelse(outcome_type== "RETURNED TO OWNER", 1, 0))) %>%
ggplot(aes(x=chip_status, fill = returned))+
geom_bar(position = "fill")
## Which dog breeds are in our data?
adoptions %>%
mutate(intake_subtype = fct_lump(intake_subtype, n=15)) %>%
group_by(intake_subtype) %>%
count(sort = TRUE)
intake <- adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE)) %>%
ggplot(aes(x=intake_month))+
geom_bar()+
ggtitle("Intake Month")
outcome <- adoptions %>%
filter(!is.na(outcome_date)) %>%
mutate(outcome_month = month(outcome_date, label = TRUE)) %>%
ggplot(aes(x=outcome_month))+
geom_bar()+ ggtitle("Outcome Month")
gridExtra::grid.arrange(intake, outcome)
income
intake
diffs=adoptions %>%
mutate(intake_month = month(intake_date, label = TRUE))
diffs
diff.Date()
?diff.Date
adoptions %>%
mutate(diff_time=difftime(intake_date, outcome_date))%>%
select(diff_time)
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time)
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time)%>%
summarise(n())
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time)%>%
unique()%>%
summarise(n())
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time)%>%
table()
adoptions%>%
filter(outcome_date==intake_date)
adoptions%>%
filter(outcome_date==intake_date)
adoptions%>%
filter(outcome_date==intake_date)%>%
select(outcome_type)
adoptions%>%
filter(outcome_date==intake_date)
adoptions%>%
filter(outcome_date==intake_date)
adoptions%>%
filter(outcome_date==intake_date)%>%
select(-intake_date, -outcome_date)
adoptions%>%
filter(outcome_date==intake_date)%>%
select(-intake_date, -outcome_date)
adoptions%>%
filter(outcome_date==intake_date)%>%
select(-intake_date, -outcome_date, -chip_status)
adoptions%>%
filter(outcome_date==intake_date)%>%
select(-intake_date, -outcome_date, -chip_status, animal_breed)
adoptions%>%
filter(outcome_date==intake_date)%>%
select(-intake_date, -outcome_date, -chip_status, -animal_breed)
adoptions%>%
filter(outcome_date==intake_date)%>%
select(-intake_date, -outcome_date, -chip_status, -animal_breed, -animal_origin)
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time)%>%
table()
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)%>%
ggplot(aes(x=month, y=diff_time))+
geom_bar(stat = "identity")
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)%>%
ggplot(aes(x=month, y=diff_time))+
geom_histogram()
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)%>%
ggplot(aes(x=diff_time, group=month))+
geom_histogram()
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)%>%
ggplot(aes(x=diff_time))+
geom_histogram()+
facet_wrap(~month)
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)%>%
ggplot(aes(x=diff_time))+
geom_density()+
facet_wrap(~as.factor(month))
adoptions %>%
mutate(diff_time=difftime(outcome_date, intake_date))%>%
select(diff_time, month)%>%
ggplot(aes(x=diff_time))+
geom_density()+
facet_wrap(~as.factor(month))
names(adoptions)
adoptions%>%
mutate(out_day=day(outcome_date),
in_day=day(intake_date))
adoptions%>%
mutate(out_day=day(outcome_date),
in_day=day(intake_date))
adoptions%>%
mutate(out_day=day(outcome_date),
in_day=day(intake_date))
adoptions%>%
mutate(out_day=day(outcome_date))%>%
ggplot(aes(x=out_day))+
geom_bar()+ ggtitle("Outcome Month")
adoptions%>%
mutate(out_day=day(outcome_date))%>%
ggplot(aes(x=out_day))+
geom_bar()+ ggtitle("Outcome Month")
adoptions%>%
mutate(out_day=day(intake_date))%>%
ggplot(aes(x=in_day))+
geom_bar()+ ggtitle("Outcome day")
adoptions%>%
mutate(in_day=day(intake_date))%>%
ggplot(aes(x=in_day))+
geom_bar()+ ggtitle("Outcome day")
